"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[6],{543:function(n,r,t){function i(n,r){for(var t=[],i=0;n.length>i;)t.push(n.slice(i,i+r)),i+=r;return t}t.d(r,"a",(function(){return i}))},546:function(n,r,t){t.d(r,"a",(function(){return h})),t.d(r,"b",(function(){return m}));var i=t(26),u=t.n(i),e=t(41),o=t(7),l=t(325),f=t(20),v=t(215),a=(t(30),t(4)),c=(t(22),t(134),t(114));t(9),new c.b("userKeys",n=>{var r=new Map;return n.child("list").forEachChild(n=>{var t=(0,v.parseUserKeysNode)(n),i=t.sessionInfo.jid;r.set(i,t)}),r});var d=t(40),s=t(543),y=t(297),j=t(296);function p(n){return w.apply(this,arguments)}function w(){return(w=u()((function*(n){for(var r=new Set,t=new Set,i=(0,d.j)()?50:100,u=(0,s.a)(n,i),e=0;e<u.length;e++){var l=u[e];yield Promise.all(l.map(n=>(0,v.ensureE2eSession)(n).then(()=>{r.add((0,o.h)(n)),t.add(n)}).catch(()=>{})))}return{userJids:r,deviceJids:t}}))).apply(this,arguments)}function h(n,r,t){var i=(0,y.e)(r.dbMsg);return p(n).then(n=>{var u=n.userJids,e=n.deviceJids;return(0,l.c)(u,r).then(n=>b(n,(0,f.c)(e),i,t))})}function m(n,r){return p(n).then(n=>{var t=n.userJids,i=n.deviceJids;return(0,l.d)(t,r).then(n=>b(n,(0,f.c)(i),void 0))})}function b(n,r,t,i){return J.apply(this,arguments)}function J(){return(J=u()((function*(n,r,t,i){var u=yield Promise.all(r.map(r=>{var t=n.get((0,o.h)(r));if(null!=t){var u,e="primary"===(null==i?void 0:i.type)?i.ids.get((0,o.e)((0,o.h)(r))):null==i||null==(u=i.ids)?void 0:u.get(r),l=null!=e&&i?{id:e,type:null==i?void 0:i.type}:void 0;return M(r,(0,j.c)(t),l)}}).filter(Boolean)),e=new Map,l=[];return u.forEach(n=>{if(n){var r=n.jid,i=n.type,u=n.ciphertext;if(!u||!i)return;l.push((0,a.w)("to",{jid:(0,a.g)(r)},(0,j.a)(i,u,t))),null!=n.identityId&&e.set(r,n.identityId)}}),{nodes:l,identityIds:e}}))).apply(this,arguments)}function M(n,r,t){return null!=(null==t?void 0:t.id)?(0,e.p)(n,r,t.id,"primary"===t.type).then(r=>{if((null==r?void 0:r.ciphertext)&&r.type)return Object.assign({},r,{jid:n})}):(0,e.o)(n,r).then(r=>Object.assign({},r,{jid:n}))}}}]);