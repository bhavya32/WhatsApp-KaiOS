"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[135],{685:function(n,r,e){e.r(r);var t=e(26),a=e.n(t),i=e(6),o=e(67),s=e(88),u=e(39),c=e(16),f=e(228),v=e(11),d=e(40),l=e(21);r.default=(0,s.c)().finalStep("saveAndPassOff",(function(){var n=a()((function*(n,r,e){e.jobStartTime;var t=n.jid,a=n.content,s=n.quoted,y=n.remoteJid,p=(0,f.k)(a.contacts.map(n=>n.vcard)),m=yield(0,o.d)(Array.from(p)),O=(function(n,r){var e=0;return{vcards:n.map(n=>{var t=n.vcard,a=(0,f.a)(t,r);return e+=a.length,a}),accSize:e+=n.length-1}})(a.contacts,m),g=O.accSize,_=O.vcards;if(g>i.I.get().vcardMaxSizeKb*v.a)return{error:{reason:"too-big"}};if(g<=i.I.get().vcardAsDocumentSizeKb*v.a)yield(0,u.b)().waitUntilPersisted(c.e.sendMsg(t,a,s,y));else{var S=(function(n){return new Blob([n.join("\n")],{type:"text/vcard",endings:"native"})})(_),h=(function(n){var r=n.contacts.map(n=>n.displayName);return(0,d.n)(r.length,r,{onEmpty:null,onSingleContact:n=>n,onOneAndOthers:(n,r)=>(0,l.k)([r,n,298]),onOthers:n=>(0,l.k)([n,299])})})(a);if(!h)return __LOG__(4)`Trying to send empty vcard msg`,SEND_LOGS("empty-vcard"),{error:{reason:"empty"}};var x={type:"text/vcard",plaintext:S,filename:h,contactsCount:_.length,uiVCards:(0,f.e)(a.contacts.map(n=>n.vcard))};yield(0,u.b)().waitUntilPersisted(c.e.sendMediaMsg(t,x,s,y))}return"success"}));return function(r,e,t){return n.apply(this,arguments)}})()).end()}}]);