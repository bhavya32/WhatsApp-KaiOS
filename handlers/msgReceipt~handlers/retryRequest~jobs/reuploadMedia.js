"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[11],{542:function(e,r,t){t.d(r,"b",(function(){return g})),t.d(r,"a",(function(){return _}));var u=t(5),n=t(10),s=t(9),o=t(7),i=t(71),d=t(62),c=t(2),a=t(46);function g(e,r){return(0,n.f)("getMsgIfAuthorized",t=>"status"===e.type?(function(e,r,t,n){return(0,a.a)(e,"r",["status","receipts"],e=>e.status.where("externalId").equals(t).toArray().then(t=>(0,u.c)(t.map(t=>l(e,t.id,t.author,s.h,n,r).then(e=>e?{type:"status",msgId:t.id}:null))))).then(e=>{var r=e.find(Boolean);return null==r?{error:"message-not-found"}:r})})(t,r,e.externalId,e.requesterJid):(e.type,(function(e,r,t,n,d){return(0,a.a)(e,"r",["msgs","receipts","contacts"],c=>{var a=(0,u.e)(!0),g=(0,o.f)(d);return g!==s.c&&(a=e.getContact((0,o.h)(d)).then(e=>!!e&&(0,i.d)(e).includes(g))),a.then(e=>e?c.msgs.where("externalId").equals(n).toArray().then(e=>(0,u.c)(e.map(e=>l(c,e.id,e.author,t,d,r).then(r=>r?e:null))).then(e=>{var r=e.find(Boolean);if(null==r)return{error:"message-not-found"};var u=r.id;return(0,o.x)(t,{user:e=>({type:"user",msgId:u,jid:e}),group:e=>({type:"group",msgId:u,jid:e})})})):(__LOG__(2)`getChatMsgIfAuthorized rejecting request for removed device`,{error:"error-unknown-device"}))})})(t,r,e.jid,e.externalId,e.requesterJid)))}function _(e,r){switch(e.type){case"device":return{type:"user",jid:e.chat,requesterJid:e.author,externalId:r};case"group":return{type:"group",jid:e.chat,requesterJid:e.author,externalId:r};case"status":return{type:"status",requesterJid:e.author,externalId:r};default:return e.type,__LOG__(4)`Unexpected receipt received for broadcastlist ${e.broadcastJid}`,SEND_LOGS("unexpected-broadcast-receipt"),{type:"user",jid:e.chat,requesterJid:e.author,externalId:r}}}function l(e,r,t,n,s,o){return t!==c.b?(__LOG__(3)`checkMsgAuthorized got request for received message`,(0,u.e)(!1)):e.receipts.get(r).then(d.r).then(e=>e?e.chat!==n?(__LOG__(3)`checkMsgAuthorized wrong jid`,SEND_LOGS("invalid-check-msg-authorized"),!1):!!(0,d.i)(e,s,o):(__LOG__(3)`checkMsgAuthorized no receipt for msg`,!1))}}}]);