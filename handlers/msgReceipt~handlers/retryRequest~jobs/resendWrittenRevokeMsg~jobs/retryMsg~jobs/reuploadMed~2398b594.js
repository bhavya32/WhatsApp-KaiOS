"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[0],{517:function(e,r,t){t.d(r,"g",(function(){return w})),t.d(r,"f",(function(){return M})),t.d(r,"c",(function(){return j})),t.d(r,"a",(function(){return C})),t.d(r,"b",(function(){return q})),t.d(r,"e",(function(){return E})),t.d(r,"h",(function(){return O})),t.d(r,"d",(function(){return A}));var n=t(8),s=t.n(n),u=t(9),i=t(7),o=t(10),p=t(36),a=t(5),f=t(90),c=t(32),g=t(11),d=t(49),m=t(46),l=t(62),y=t(82),I=t(187),v=t(35),h=t(185),b=t(184);function w(e){return"status"===e.type?u.h:e.jid}function M(e){return"status"===e.type||"chat"===e.msgType||"reaction"===e.msgType||"keepInChat"===e.msgType||e.msgType,e.dbMsg.id}function j(e){return(0,o.f)("getSentMsgInfo",r=>(0,c.J)(e,{chat:e=>(0,m.a)(r,"r",["chats","msgs","previews","media"],r=>(0,p.r)(r,e).then(e=>(0,d.f)(r,e))).then(P),status:e=>(0,m.a)(r,"r",["status","media","previews"],r=>(0,y.h)(r,e).then(e=>(0,y.c)(r,e))).then(U),reaction:e=>(0,m.a)(r,"r",["msgs","reactions"],r=>(0,I.e)(r,e)).then(S),keepInChat:e=>(0,m.a)(r,"r",["msgs","chats","groups","groupParticipantsInfo"],r=>(0,h.c)(r,e)).then(T),pollUpdate:e=>(0,m.a)(r,"r",["msgs","pollUpdates"],r=>(0,b.e)(r,e)).then(e=>(0,b.c)(e).then(r=>k(e,r)))}))}function P(e){if(!e)return Promise.resolve();var r=e.dbMsg,t=e.dbMedia,n=e.preview,i=e.quotePreview,o=e.jid,p=n?(0,g.h)(n):Promise.resolve(),a=i?(0,g.h)(i):Promise.resolve();return Promise.all([p,a]).then(e=>{var n=s()(e,2),i=n[0],p=n[1],a=null;(t||i)&&(a=(0,f.g)(r.id,i,t));var c=(0,f.k)(r,p);return(0,u.L)(o,{user:e=>({type:"user",msgType:"chat",jid:e,dbMsg:r,mediaInfo:a,quoteInfo:c}),group:e=>({type:"group",msgType:"chat",jid:e,dbMsg:r,mediaInfo:a,quoteInfo:c})})})}function U(e,r){if(!e)return Promise.resolve();var t=e.dbMsg,n=e.dbMedia,s=e.preview;return n||s?(s?(0,g.h)(s):Promise.resolve()).then(e=>{var r=(0,f.g)(t.id,e,n);return{type:"status",dbMsg:t,mediaInfo:r}}):Promise.resolve({type:"status",dbMsg:t,mediaInfo:null})}function S(e){if(e)return(0,u.L)(e.chatJid,{user:r=>({type:"user",msgType:"reaction",jid:r,dbMsg:e}),group:r=>({type:"group",msgType:"reaction",jid:r,dbMsg:e})})}function T(e){if(e)return(0,u.L)(e.chatJid,{user:r=>({type:"user",msgType:"keepInChat",jid:r,dbMsg:e}),group:r=>({type:"group",msgType:"keepInChat",jid:r,dbMsg:e})})}function k(e,r){if(e&&r)return(0,u.L)(e.chatJid,{user:t=>({type:"user",msgType:"pollUpdate",jid:t,dbMsg:e,encryptedUpdate:r}),group:t=>({type:"group",msgType:"pollUpdate",jid:t,dbMsg:e,encryptedUpdate:r})})}function C(e){return(0,o.f)("getMsgAndReceipt",r=>(0,c.J)(e,{chat:e=>(0,m.a)(r,"r",["chats","msgs","previews","media","receipts"],r=>(0,a.c)([(0,p.r)(r,e).then(e=>(0,d.f)(r,e)),(0,l.h)(r,e)])).then(e=>{var r=s()(e,2),t=r[0],n=r[1];return P(t).then(e=>({receipt:n,msgInfo:e}))}),status:e=>(0,m.a)(r,"r",["status","previews","media","receipts"],r=>(0,a.c)([(0,y.h)(r,e).then(e=>(0,y.c)(r,e)),(0,l.h)(r,e)])).then(e=>{var r=s()(e,2),t=r[0],n=r[1];return U(t).then(e=>({receipt:n,msgInfo:e}))}),reaction:e=>(0,m.a)(r,"r",["msgs","reactions","receipts"],r=>(0,a.c)([(0,I.e)(r,e),(0,l.h)(r,e)])).then(e=>{var r=s()(e,2),t=r[0],n=r[1];return{msgInfo:S(t),receipt:n}}),keepInChat:e=>(0,m.a)(r,"r",["msgs","chats","receipts","groups","groupParticipantsInfo"],r=>(0,a.c)([(0,h.c)(r,e),(0,l.h)(r,e)])).then(e=>{var r=s()(e,2),t=r[0],n=r[1];return{msgInfo:T(t),receipt:n}}),pollUpdate:e=>(0,m.a)(r,"r",["msgs","pollUpdates","receipts"],r=>(0,a.c)([(0,b.e)(r,e),(0,l.h)(r,e)])).then(e=>{var r=s()(e,2),t=r[0],n=r[1];return(0,b.c)(t).then(e=>({msgInfo:k(t,e),receipt:n}))})}))}function q(e,r){return(0,c.J)(r,{chat:r=>(0,p.r)(e,r).then(e=>{if(null!=e)return{type:"ownStore",dbMsg:e}}),status:r=>(0,y.h)(e,r).then(e=>{if(null!=e)return{type:"ownStore",dbMsg:e}}),reaction:r=>(0,I.d)(e,r).then(e=>{if(null!=e)return{type:"ownStore",dbMsg:e}}),keepInChat:r=>(0,h.d)(e,r).then(e=>{if(null!=e)return{type:"embedded",embeddedMsg:e}}),pollUpdate:r=>(0,b.d)(e,r).then(e=>{if(null!=e)return{type:"ownStore",dbMsg:e}})})}function E(e,r){if("ownStore"===r.type){var t=r.dbMsg;if((0,v.c)(t))return e.msgs.put(t).then(()=>{});if((0,v.m)(t))return e.status.put(t).then(()=>{});if((0,v.l)(t))return e.reactions.put(Object.assign({},t)).then(()=>{});if((0,v.j)(t))return e.pollUpdates.put(Object.assign({},t)).then(()=>{});throw new Error("Invalid type of message")}r.type,r.embeddedMsg;var n=r.embeddedMsg;return(0,p.r)(e,n.msgId).then(r=>{if(null!=r){var t=r.keptInfo;if(null!=t&&t.externalId===n.externalId&&t.author===n.author)return t.ack=n.ack,null!=n.resendCount?t.resendCount=n.resendCount:delete t.resendCount,t.ts=n.ts,e.msgs.put(r).then(()=>{})}})}function O(e,r){if("ownStore"===e.type){var t=e.dbMsg;if((0,v.c)(t))return r.chat(t);if((0,v.m)(t))return r.status(t);if((0,v.l)(t))return r.reaction(t);if((0,v.j)(t))return r.pollUpdate(t);throw new Error("Invalid type of message")}return e.type,e.embeddedMsg,r.keepInChat(e.embeddedMsg)}function A(e,r){return(0,o.f)("getSentMsgInfo",t=>(0,i.a)(e)?(0,m.a)(t,"r",["chats","msgs","previews","media"],e=>e.msgs.where("rowId").equals(r).first().then(r=>(0,d.f)(e,r))).then(P):(0,m.a)(t,"r",["status","media","previews"],e=>e.status.where("rowId").equals(r).first().then(r=>(0,y.c)(e,r))).then(U))}}}]);